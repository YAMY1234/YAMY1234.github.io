<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>project collections: RSA Encrypt System | Chase your light, and light up your life!</title><meta name="keywords" content="Rabbit, here we go!"><meta name="author" content="YAMY"><meta name="copyright" content="YAMY"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="2021 Modern Cryptography Curriculum Design TaskSummaryThis paper is to write the modern cryptography curriculum practical experiment report, the implementation of the content mainly includes: DES Al">
<meta property="og:type" content="article">
<meta property="og:title" content="project collections: RSA Encrypt System">
<meta property="og:url" content="http://yamy1234.github.io/2022/12/13/project-collections-RSA_Encript_System/index.html">
<meta property="og:site_name" content="Chase your light, and light up your life!">
<meta property="og:description" content="2021 Modern Cryptography Curriculum Design TaskSummaryThis paper is to write the modern cryptography curriculum practical experiment report, the implementation of the content mainly includes: DES Al">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://yamy1234.github.io/img/1.jpg">
<meta property="article:published_time" content="2022-12-13T04:16:37.000Z">
<meta property="article:modified_time" content="2022-12-13T04:17:16.443Z">
<meta property="article:author" content="YAMY">
<meta property="article:tag" content="Rabbit, here we go!">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yamy1234.github.io/img/1.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://yamy1234.github.io/2022/12/13/project-collections-RSA_Encript_System/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'project collections: RSA Encrypt System',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-12-13 12:17:16'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/head.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">19</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">6</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/1.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Chase your light, and light up your life!</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">project collections: RSA Encrypt System</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-12-13T04:16:37.000Z" title="Created 2022-12-13 12:16:37">2022-12-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-12-13T04:17:16.443Z" title="Updated 2022-12-13 12:17:16">2022-12-13</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="project collections: RSA Encrypt System"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><img src="wps56.png" alt="img"> </p>
<h1 id="2021-Modern-Cryptography-Curriculum-Design-Task"><a href="#2021-Modern-Cryptography-Curriculum-Design-Task" class="headerlink" title="2021 Modern Cryptography Curriculum Design Task"></a>2021 Modern Cryptography Curriculum Design Task</h1><h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>This paper is to write the modern cryptography curriculum practical experiment report, the implementation of the content mainly includes: DES Algorithm design, AES Algorithm design, ANSI X9.17 Algorithm to achieve pseudo-random number bit generator, Miller Ruobing primacy detection Algorithm, RSA key generation, AES-CBC model encryption, decrypt files, RSA encryption, decryption session key, etc. C++ language , developed based on Visual Studio 2019, mainly based on NTL library as an additional dependent static link library to realize the data structure and Function basis of prime detection, RSA encryption and decryption and other related Algorithms.</p>
<p>The final result implements three different plates for three different programming tasks: generate ALICE RSA key plate; BOB encrypts the file m and sends it to ALICE plate; ALICE decrypts and recovers the file m plate. In the programming process, attention is paid to details, file storage of the key, etc. In order not to introduce the influence of intermediate variables on the result, each plate is selected by the user independently, and the program is terminated after each set of plates mentioned above, and the program is called again for key generation, encryption or decryption next time.</p>
<h1 id="Chapter-1-Topic-Background"><a href="#Chapter-1-Topic-Background" class="headerlink" title="Chapter 1, Topic Background"></a>Chapter 1, Topic Background</h1><h2 id="Programming-tasks-and-requirements"><a href="#Programming-tasks-and-requirements" class="headerlink" title="Programming tasks and requirements"></a>Programming tasks and requirements</h2><h3 id="Alice-generates-RSA-key"><a href="#Alice-generates-RSA-key" class="headerlink" title="Alice generates RSA key:"></a>Alice generates RSA key:</h3><h4 id="description"><a href="#description" class="headerlink" title="description"></a>description</h4><p>Alice generates a pair of RSA Public key (n, b) and private key (p, q, a), where the random primes p, q are both 512 bits long, or 1024 bits long: both lengths are supported.</p>
<h4 id="request"><a href="#request" class="headerlink" title="request"></a>request</h4><p>Based on open source code NTL implementation, NTL is a popular high-precision algebraic number theory library in the cryptography world. No other methods are supported. NTL URL: <a target="_blank" rel="noopener" href="https://www.shoup.net/ntl/">https://www.shoup.net/ntl/</a>. There are detailed instructions on the website or in the downloaded doc.</p>
<p>Note: In order to ensure that the probability of passing the primacy test is large enough, it is necessary to test enough times, such as generating a 512-bit prime number, the probability that the number passing the test is not a prime number (that is, the error probability) is close to 1&#x2F;2512.</p>
<h3 id="Bob-encrypts-file-m-and-sends-it-to-Alice"><a href="#Bob-encrypts-file-m-and-sends-it-to-Alice" class="headerlink" title="Bob encrypts file m and sends it to Alice:"></a>Bob encrypts file m and sends it to Alice:</h3><h4 id="description-1"><a href="#description-1" class="headerlink" title="description"></a>description</h4><ol>
<li><p>The input file is of arbitrary length. How to convert the file to the required format, please decide by yourself. In the CBC model, if the length of m is not a multiple of the packet, you need to fill it, please decide how to fill it, but you need to remove the filling when decrypting.</p>
</li>
<li><p>Generate a 128-bit random number $k$ as a temporary session key.</p>
</li>
<li><p>Encrypt k with Alice’s public key to get <code>c1 - kb mod n</code>.</p>
</li>
</ol>
<p>4, with the session key k to encrypt the file m to obtain c2, where the encryption Algorithm is AES , using the CBC model.</p>
<ol start="5">
<li>Send <em>(c1, c2)</em> to Alice.</li>
</ol>
<h4 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h4><p>AES column mixing operation and its inverse operation using fast Algorithm provided in my courseware. S-Box using look-up table to achieve. AES AES test data can refer to AES ash animation.</p>
<h3 id="1-3-Alice-decrypts-and-recovers-file-m"><a href="#1-3-Alice-decrypts-and-recovers-file-m" class="headerlink" title="1.3 Alice decrypts and recovers file m"></a>1.3 Alice decrypts and recovers file m</h3><h4 id="1-3-1-Description"><a href="#1-3-1-Description" class="headerlink" title="1.3.1 Description"></a>1.3.1 Description</h4><p>Decrypt $c1 $with Alice’s RSA private key to get $k $.</p>
<ol start="2">
<li><p>Decrypt $c2 $ with $k$ to get $m $.</p>
</li>
<li><p>Output $m $.</p>
</li>
</ol>
<h2 id="Restriction-requirements"><a href="#Restriction-requirements" class="headerlink" title="Restriction requirements"></a>Restriction requirements</h2><p>The random numbers mentioned above (including random prime number generation, IV in CBC) should be generated by ANSI X9.17 Algorithm, and cannot be generated by the pseudo-random number Function provided by the system. Random numbers for cryptographic purposes need to be generated by the pseudo-random number Algorithm dedicated to cryptographic purposes.</p>
<p>Algorithm ANSI X9.17 Pseudorandom Number Bit Generator</p>
<p>Inputs: Random (secret) 64-bit seed $s $, integer $m $, two DES keys $k1, k2 $.</p>
<p>Output: $m $64-bit random bit strings $x_1, x_2,…, x_m $.</p>
<p>$ I &#x3D; DES_ {k1} (DES_k2 ^ {-1} (DES_ {k1} (D))) $, where $D $ represents an exact representation of the current date&#x2F;time, and $ DES $ represents DES encryption. $DES ^ {-1} $represents DES decryption.</p>
<p>2、<code>For i=1 to m</code>:<br>$$<br>x_i &#x3D; DES_{k1}(DES_k2^{-1}(DES_{k1}(I\oplus s)))\<br>s &#x3D; DES_{k1}(DES_k2^{-1}(DES_{k1}(x_i\oplus I)))<br>$$<br>3, Returns $x_1, x_2,…, x_m $.</p>
<h1 id="Chapter-2-Programming-Instructions"><a href="#Chapter-2-Programming-Instructions" class="headerlink" title="Chapter 2, Programming Instructions"></a>Chapter 2, Programming Instructions</h1><h2 id="Programming-Overall-Architecture"><a href="#Programming-Overall-Architecture" class="headerlink" title="Programming Overall Architecture"></a>Programming Overall Architecture</h2><h3 id="RSA-Encryption-System-Overall-Framework"><a href="#RSA-Encryption-System-Overall-Framework" class="headerlink" title="RSA Encryption System Overall Framework"></a>RSA Encryption System Overall Framework</h3><p><img src="wps63.jpg" alt="img"> </p>
<p>The overall construction of the program is shown in the figure above. It mainly includes the content of three large sections:</p>
<ol>
<li>Alice generates RSA key</li>
</ol>
<p>Specifically, it involves three sub-modules: random prime generation, key generation and key storage, among which the random prime generation calls the $ANSI X9.17 random number generator (internal design triple DES Algorithm), and the Miller Ruo ice primacy detection module.</p>
<ol start="2">
<li>Bob encrypts files</li>
</ol>
<p>Specifically, it relates to a temporary session key generation sub-module (including ANSI X9.17 random prime number generator internally), AES-CBC file encryption sub-module, and (c1, c2) ciphertext generation and preservation sub-module, wherein the AES-CBC file encryption sub-module internally contains AES Algorithm, CBC model encrypted file, storage format conversion three sub-modules.</p>
<ol start="3">
<li>Alice decrypts the file</li>
</ol>
<p>Specifically, it involves RSA private key decryption, AES-CBC model decrypts the file, saves the file after decryption and outputs three sub-modules.</p>
<h3 id="1-5-General-framework-for-programming"><a href="#1-5-General-framework-for-programming" class="headerlink" title="1.5 General framework for programming"></a>1.5 General framework for programming</h3><p>In RSA In the Algorithm description described in the overall framework of the encryption system, the following core component modules are involved. It is organized here and used as the main framework for code generation:</p>
<ol>
<li><p>DES Algorithm, as the core of ANSI X9.17 random number generator</p>
</li>
<li><p>ANSI X9.17, call DES Algorithm to generate random numbers</p>
</li>
<li><p>PrimeTest primality detection module, as the core guarantee of key generation</p>
</li>
<li><p>RSA Key generation module, calling the above module to generate RSA encryption, decryption keys</p>
</li>
<li><p>AES Algorithm, as the file encryption basis for </p>
</li>
<li><p>AES-CBC file encryption&#x2F;decryption, as the core module of file encryption</p>
</li>
<li><p>RSA Encryption&#x2F;decryption. Use RSA own basis for encryption and decryption of session keys to call AES-CBC for file encryption and decryption to form a complete system</p>
</li>
<li><p>Top-level modules, integrate all the above-mentioned sub-top-level modules and realize functions</p>
</li>
</ol>
<h2 id="Programming-Detailed-design-instructions-for-each-module"><a href="#Programming-Detailed-design-instructions-for-each-module" class="headerlink" title="Programming Detailed design instructions for each module"></a>Programming Detailed design instructions for each module</h2><h2 id="Algorithm-Design"><a href="#Algorithm-Design" class="headerlink" title="Algorithm Design"></a>Algorithm Design</h2><h3 id="Algorithm-principle"><a href="#Algorithm-principle" class="headerlink" title="Algorithm principle"></a>Algorithm principle</h3><p>DES (Data Encryption Standard) is one of the most popular encryption algorithms. DES It is symmetric, which means that it uses the same key to encrypt and decrypt data.</p>
<p>DES It is also a packet encryption algorithm, which processes a fixed-length data segment at a time, called a packet. DES The size of the packet is 64 bits. If the length of the encrypted data is not a multiple of 64 bits, the bits can be filled according to some specific rules.</p>
<p>Essentially, DES The security of Plain Text relies on false appearances, which in cryptographic terms relies on the principle of “chaos and diffusion.” The purpose of chaos is to hide any relationship between Plain Text and the ciphertext, or key, while the purpose of diffusion is to make the valid bits in Plain Text and the key together to form as many ciphertexts as possible. The combination of the two makes for relatively high security.</p>
<p>DES The algorithm encrypts the Plain Text by performing a series of permutations and substitutions. The key to the process is to obtain the Function of the 16 subkeys from the given initial key. To encrypt a set of Plain Text, each subkey is applied to the data in a series of bit operations in sequence (1-16), once for each subkey, repeating a total of 16 times. Each iteration is called a round. The same steps can be used to decrypt the ciphertext, except that the subkey processes the ciphertext in reverse order (16-1).</p>
<h5 id="Calculate-16-subkeys"><a href="#Calculate-16-subkeys" class="headerlink" title="Calculate 16 subkeys"></a>Calculate 16 subkeys</h5><p>The above mentioned DES The first step of the Algorithm is to calculate 16 subkeys from the initial key. The illustration shows this process. DES use a 56-bit initial key, but here is a 64-bit value. This is because every 8 bits can be used for parity in the Hardware implementation, and the extra bits are simply ignored in the software implementation. To obtain a 56-bit key, you can perform key conversion as shown in License Table 1. Explain Table 1. Viewed from left to right, top to bottom, each position P in the table contains the position of the bit in the initial key in the converted key. For example, bit 57 in the initial key becomes bit 1 in the converted key, bit 49 in the initial key becomes bit 2 in the converted key, and so on….</p>
<p><img src="wps64.png" alt="img"> </p>
<p>Figure 2 DES Conversion table of keys in Figure 2 (DesTransform [56])</p>
<p>After converting the key to 56 bits, the sub-keys are calculated. First, the 56-bit key is divided into two 28-bit groups. Then, for each sub-key, according to the sequence value of the sub-key (that is, the number of bits in the 16 sub-keys), the two sets of values are rotated (see Table 2 for the number of bits rotated), and then merged again. Afterwards, the reconstituted key is replaced as shown in Table 3, so that the 56-bit sub-key is reduced to 48 bits (note that Table 3 only has 48 bits, but discards 8 bits). This arrangement process is called replacement selection.</p>
<p>For 16 subkeys, repeat the process once for each subkey. The purpose here is to ensure that different bits in the initial key are applied to the encrypted data after each round of permutation.</p>
<p><img src="wps65.png" alt="img"> </p>
<p><img src="wps66.png" alt="img"> </p>
<p><img src="wps67.jpg" alt="img"> </p>
<h5 id="Encrypt-and-decrypt-data-block"><a href="#Encrypt-and-decrypt-data-block" class="headerlink" title="Encrypt and decrypt data block"></a>Encrypt and decrypt data block</h5><p>After the above process, we have prepared the subkey. Then you can encrypt and decrypt the data block. Figure 2 shows this process.</p>
<p><img src="wps68.jpg" alt="img"> </p>
<p>Replacing a 64-bit data block in the way shown above begins, a process called initial permutation. This process does not increase the security of DES , but this practice made it easier to load data into DES chips before the advent of 16- and 32-bit buses. Although this process is outdated, the permutation process is still retained to meet DES criteria.</p>
<p><img src="wps69.png" alt="img"> </p>
<p>After the initial permutation, the 64-bit data block is divided into two 32-bit groups, L0 and R0. After the initial permutation, the data block will repeat a series of operations for 16 rounds. The purpose of each round of operations ( i ) is to calculate Li and Ri, and these results will be used in the next round of operations until the data $R16 $and $L16 $are finally obtained.</p>
<p>Each round starts with $Li-1 $and $Ri-1 $, and then performs an extended permutation as shown in the table, expanding $R_ {i-1} $from 32 bits to 48 bits. The main purpose of this permutation is to create some avalanche effect in the process of encrypting data. Using 1 bit in the data block will affect more bits in the next operation, resulting in a diffusion effect.</p>
<p>Once the extended permutation is complete, calculate the exclusive OR of the 48-bit result value to this wheel key $K_i $ (<strong>XOR</strong>, in sign-wise). This produces a 48-bit intermediate value, denoted as $R_ {int} $.</p>
<p>If E is counted as the result of extended permutation, the operation so far in this round can be expressed as:</p>
<p>$$R_{int} &#x3D; E（Ri-1) ⊕ Ki$$</p>
<p><img src="wps72.png" alt="img"> </p>
<p>Next, $R_ {int} $needs to perform 8 substitutions through 8 separate S boxes. Each S box (j) takes 6 bits from $6j $to $6j + 6 $of $R_ {int} $, finds a 4-bit value for it in the table, and writes the value to the buffer at $4j $.</p>
<p><img src="wps73.png" alt="img"> </p>
<p><img src="wps74.jpg" alt="img"> </p>
<p><img src="wps75.jpg" alt="img"> </p>
<p>Once the S-box replacement is complete, the result is changed to a 32-bit value. Next, replace it with the P-box. As shown in the table below.</p>
<p><img src="wps76.jpg" alt="img"> </p>
<p>So far, we have imagined this round of operations as a Function, generally denoted f. If $b_j $represents the $j $6-bit group in $R_int $, $S_j $represents the jth S-box, and P represents the P-box permutation, the Function can be defined as:<br>$$<br>f &#x3D; P(S1(b1),S2(b2),…,S8(b8))<br>$$<br>The last operation of each round is to calculate the exclusive OR value between the 32-bit result value of f and the left packet Li-1 of the original data source passed to the current round of operations.</p>
<p>Once completed, the left and right packets are switched and the next round begins. In the last round, left and right packets are not exchanged.</p>
<p>Connecting all the steps, the steps to calculate $Li $and $Ri $in each round can be represented exactly as:<br>$$<br>L_i &#x3D; R_i - 1\<br>R_i &#x3D; (L_i-1)\oplus F(R_i-1,K_i)\<br>L_i &#x3D; R_i -1<br>$$<br>When all 16 rounds of operations are completed, the last right packet $R16 $and the last remaining left packet $L16 $are connected to form a 64-bit packet $R16-L16 $.</p>
<p>The final step is to replace R16-L16. In short, undo the previous initial permutation. When encrypting the data, the end result is a 64-bit ciphertext, and when decrypting the data, the end result is a 64-bit Plain Text.</p>
<p><img src="wps80.jpg" alt="img"> </p>
<h4 id="DES-Algorithm-implementation"><a href="#DES-Algorithm-implementation" class="headerlink" title="DES Algorithm implementation"></a>DES Algorithm implementation</h4><p>By establishing DES classes to encapsulate the corresponding data members and Function members, as well as external implementation and calling interfaces.</p>
<h5 id="data-member"><a href="#data-member" class="headerlink" title="data member"></a>data member</h5><p>Data members mainly include initial permutation table, key initial permutation table, key cycle shift number table, key compression permutation table, data expansion table, s-box permutation table, final permutation table. A total of 8 tables and the initial key given to DES Encryption. The specific information is defined as follows:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">DES</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="comment">/*** Data Initial Replacement Table***/</span></span><br><span class="line">    <span class="type">int</span> T1[<span class="number">8</span>][<span class="number">8</span>];</span><br><span class="line"><span class="comment">/*** Key Initial Replacement Table***/</span></span><br><span class="line">    <span class="type">int</span> T2[<span class="number">8</span>][<span class="number">7</span>];</span><br><span class="line"><span class="comment">/*** key cycle left shift digit table***/</span></span><br><span class="line">    <span class="type">int</span> T3[<span class="number">16</span>];</span><br><span class="line"><span class="comment">/*** key compression permutation table***/</span></span><br><span class="line">    <span class="type">int</span> T4[<span class="number">8</span>][<span class="number">6</span>];</span><br><span class="line"><span class="comment">/*** data extension table***/</span></span><br><span class="line">    <span class="type">int</span> T5[<span class="number">8</span>][<span class="number">6</span>];</span><br><span class="line"><span class="comment">/*** S box replacement table***/</span></span><br><span class="line">    <span class="type">int</span> S[<span class="number">8</span>][<span class="number">4</span>][<span class="number">16</span>];</span><br><span class="line"><span class="comment">/*** P box replacement table***/</span></span><br><span class="line">    <span class="type">int</span> P[<span class="number">4</span>][<span class="number">8</span>];</span><br><span class="line"><span class="comment">/*** Final replacement table***/</span></span><br><span class="line">    <span class="type">int</span> T6[<span class="number">8</span>][<span class="number">8</span>];</span><br><span class="line">    string Keys[<span class="number">20</span>];</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="Function-member"><a href="#Function-member" class="headerlink" title="Function member"></a>Function member</h5><p>Mainly includes encapsulation implementation DES Algorithm of each Function, through the string class to complete the implementation, the specific Function definition is as follows, the specific Function implementation and the specific analysis of each Function reference appendix.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">DES</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">...</span><br><span class="line"><span class="keyword">public</span>:   </span><br><span class="line">   <span class="function">string <span class="title">DES_encrypt</span><span class="params">(string P, string K)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">DES_decrypt</span><span class="params">(string C, string K)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">generateKeys</span><span class="params">(string s)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">decrypt</span><span class="params">(string str)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">encrypt</span><span class="params">(string str1)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">f</span><span class="params">(string str1, string str2)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">G</span><span class="params">(string str)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">H</span><span class="params">(string s)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">plaintext_initial_permutation</span><span class="params">(string s)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">secret_key_initial_permutation</span><span class="params">(string s)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">secret_ket_left_move</span><span class="params">(<span class="type">int</span> k, string s)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">secret_key_compression_replacement</span><span class="params">(string s)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">plaintext_righthalf_extended_permutation</span><span class="params">(string s)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">XOR</span><span class="params">(string s1, string s2)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">S_box</span><span class="params">(string s)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">P_box</span><span class="params">(string s)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">final_permutation</span><span class="params">(string s)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h3 id="ANSI-X9-17-Module-Algorithm-Design"><a href="#ANSI-X9-17-Module-Algorithm-Design" class="headerlink" title="ANSI X9.17 Module Algorithm Design"></a>ANSI X9.17 Module Algorithm Design</h3><h4 id="ANSI-X9-17-Algorithm-Principle"><a href="#ANSI-X9-17-Algorithm-Principle" class="headerlink" title="ANSI X9.17 Algorithm Principle"></a>ANSI X9.17 Algorithm Principle</h4><h4 id="Algorithm-Background"><a href="#Algorithm-Background" class="headerlink" title="Algorithm Background"></a>Algorithm Background</h4><p>The $ANSI X9.17 $standard is the key management specification for Financial Institutions formulated by the US National Standards Institute; the $ANSI $ (US National Standards Institute) groups responsible for financial security are $ASC X9 $and $ASC X12 $. Among them, $ASC X9 $is responsible for formulating financial business standards, and $ASC X12 $is responsible for formulating commercial transaction standards. The $ANSI X9.17 $standard was formulated in 1985 and regulates key management for Financial Institutions.</p>
<p>In most cases, we use a specific cryptographic algorithm to assist in the generation of random numbers, $ANSI X9.17 $is no exception, its Algorithm is based on the famous DES (data encryption standard).</p>
<p>Data encryption standard (Data Encryption Standard, DES) is the world’s most widely used and popular block cipher algorithm, its packet length of 64 bits, the key length of 56 bits, it is developed by the US IBM company, derived from an early called Lucifer cipher development and modification.</p>
<p>DES Is an iterative block cipher that uses a technique called Feistel, in which the encrypted block of text is split in half. A subkey is used to apply a loop to one half, then the output is “XOR” with the other half; the halves are then swapped, and the process continues, but the last loop is not swapped. DES uses 16 loops.</p>
<p>In order to improve security, people usually do not use a simple DES , but use DES Algorithm in multiple keys, such as triple DES of two keys. This scheme has been proved to be effective and has been adopted in the key management standards $ANSI X9.17 $and $ ISO 8732 $.</p>
<h5 id="Algorithm-implementation-process"><a href="#Algorithm-implementation-process" class="headerlink" title="Algorithm implementation process"></a>Algorithm implementation process</h5><p>The EDE in the figure above represents a triple algorithm of two keys DES Algorithm; the generator has three main components.</p>
<ol>
<li><p>Input, the input is two 64-bit pseudo-random numbers, where $DT_i $ represents the current date and time; after each number $R_i $, $DT_i $ will be updated once; $V_i $ is the seed when the first $ i $ random number, its initial value can be arbitrarily set, and it will be automatically updated every time.</p>
</li>
<li><p>key, the generator uses three triple encryption, three encryption using the same two 56-bit keys $K1 $and $K_2 $, these two keys must be kept secret and can not be used for other purposes. DES </p>
</li>
<li><p>Output, the output is a 64-bit pseudo-random number $R_i $ and a 64-bit new seed $V_ {i + 1} $.</p>
</li>
</ol>
<p>This scheme has high cryptographic strength because it uses a 112-bit long key and 9 DES Encryption, but also because the Algorithm is driven by two pseudo-random number inputs, one is the current date and time, and the other Algorithm last generated a new seed; and even if the random number $R_i $is leaked, but because $R_i $is encrypted by $EDE $again before generating a new seed $V_ { i + 1} $, so even if someone else gets $Ri $, they will not get V_ {i + 1} $, so they will not get the new random </p>
<h4 id="Algorithm-description"><a href="#Algorithm-description" class="headerlink" title="Algorithm description"></a>Algorithm description</h4><p>Inputs: Random (secret) 64-bit seed $s $, integer $m $, two keys $k_1, k_2 $. DES keys $,  $.</p>
<p>Output: m 64-bit random bits $x_1, x_2,…, x_m $</p>
<p>$I &#x3D; DES_ {k1} (DES_k2 ^ {-1} (DES_ {k1} (D))) $, where $D $ represents an exact representation of the current date&#x2F;time, and $ DES $represents<strong>DES</strong> encryption. $DES ^ {-1} $represents<strong>DES</strong>decryption.</p>
<p>2、<code>For i=1 to m</code>:<br>$$<br>x_i &#x3D; DES_{k1}(DES_k2^{-1}(DES_{k1}(I\oplus s)))\<br>s &#x3D; DES_{k1}(DES_k2^{-1}(DES_{k1}(x_i\oplus I)))<br>$$<br>3, Returns $x_1, x_2,…, x_m $.</p>
<h4 id="ANSI-X9-17-Algorithm-Implementation"><a href="#ANSI-X9-17-Algorithm-Implementation" class="headerlink" title="ANSI X9.17 Algorithm Implementation"></a>ANSI X9.17 Algorithm Implementation</h4><p>The role of ANSI X9.17 Algorithm is to generate random numbers. In the subsequent AES random key generation, RSA p, q generation, etc. need to be used, so we also encapsulate it as a class for subsequent use, because it inherits from DES class, including only three class members Function. The roles are:</p>
<h5 id="string-threeDES-string-a-string-key1-string-key2-DES-des"><a href="#string-threeDES-string-a-string-key1-string-key2-DES-des" class="headerlink" title="string threeDES(string a, string key1, string key2, DES des)"></a>string threeDES(string a, string key1, string key2, DES des)</h5><p>Implement triple DES Algorithm.</p>
<h5 id="string-string-to-hex-const-string-amp-str"><a href="#string-string-to-hex-const-string-amp-str" class="headerlink" title="string string_to_hex(const string&amp; str)"></a>string string_to_hex(const string&amp; str)</h5><p>Implement the conversion of string to hex.</p>
<h5 id="Ansi-int-m-string-key1-string-key2-string-s-char-result"><a href="#Ansi-int-m-string-key1-string-key2-string-s-char-result" class="headerlink" title="Ansi(int m, string key1, string key2, string s, char** result)"></a>Ansi(int m, string key1, string key2, string s, char** result)</h5><p>Call triple DES Algorithm’s top-level module. It involves the following class and class member Function. Refer to the appendix for specific detailed code.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ANSI</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function">string <span class="title">threeDES</span><span class="params">(string a, string key1, string key2, DES des)</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Ansi</span><span class="params">(<span class="type">int</span> m, string key1, string key2, string s, <span class="type">char</span>** result)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">string_to_hex</span><span class="params">(<span class="type">const</span> string&amp; str)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>PrimeTest Algorithm Design</p>
<h4 id="The-Principle-of-Miller-Ruo-Ice-Primality-Detection-Algorithm"><a href="#The-Principle-of-Miller-Ruo-Ice-Primality-Detection-Algorithm" class="headerlink" title="The Principle of Miller Ruo Ice Primality Detection Algorithm"></a>The Principle of Miller Ruo Ice Primality Detection Algorithm</h4><h5 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h5><p>The Miller-Rabin Algorithm can check whether a super large positive integer n is prime in $ O (klog2 (n)) $, the number of times k sets itself to check whether a super large positive integer n is prime. The naked Miller-Rabin Algorithm’s probability of error in verifying whether a number is prime decreases with the number of tests (it cannot be reduced to 0)</p>
<p>Miller-Rabin is a stochastic Algorithm and the result is 75% correct, so the Function should be called multiple times to increase the probability of correct to 1 dollar − (1&#x2F;4) ^ k $.</p>
<p>Realization of Miller Ruo Ice Primality Detection Algorithm</p>
<p>Since the Primality Detection Algorithm is also mostly used in other modules, it is also encapsulated with a Prime class as a basic module. Specifically, it includes two Functions</p>
<ol>
<li><p><code>long witness (const ZZ &amp; n, const ZZ &amp; x)</code> is used as the basic prime detection Function of each round of prime detection.</p>
</li>
<li><p><code>long PrimeTest (const ZZ &amp; n, long t)</code> as the top-level Function of prime detection, call witness Function for each round of testing.</p>
</li>
</ol>
<p>The following are the packaged prime detection Prime class and class member Function. For specific detailed codes, please refer to the appendix.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Prime</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="type">long</span> <span class="title">witness</span><span class="params">(<span class="type">const</span> ZZ&amp; n, <span class="type">const</span> ZZ&amp; x)</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">long</span> <span class="title">PrimeTest</span><span class="params">(<span class="type">const</span> ZZ&amp; n, <span class="type">long</span> t)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="AES-Algorithm-Design"><a href="#AES-Algorithm-Design" class="headerlink" title="AES Algorithm Design"></a>AES Algorithm Design</h3><h4 id="AES-Algorithm-principle"><a href="#AES-Algorithm-principle" class="headerlink" title="AES Algorithm principle"></a>AES Algorithm principle</h4><h4 id="Algorithm-Overview"><a href="#Algorithm-Overview" class="headerlink" title="Algorithm Overview"></a>Algorithm Overview</h4><p>The US National Institute of Standards and Technology (NIST) established the new Advanced Data Encryption Standard ( AES ) specification on May 26, 2002. In this article I will provide a working implementation of AES written in C # and explain in detail what exactly AES is and how the encoding works. I will show you how to encrypt data with AES and extend the code presented in this article to develop a commercial-grade quality AES class. I’ll also explain how and why to incorporate AES into your software system, and how to test AES-based software.</p>
<p>Note that the code provided in this article and any other implementations based on this article are within the scope of federated encryption module export controls (see Commercial Encryption Export Controls for details).</p>
<p>AES AES is a new encryption algorithm that can be used to protect electronic data. Specifically, AES is an iterative, symmetric-key grouped cipher that can encrypt and decrypt data using 128, 192, and 256-bit keys in 128-bit (16-byte) groupings. Unlike public-key ciphers that use key pairs, symmetric-key ciphers use the same key to encrypt and decrypt data. The encrypted data returned by a block cipher has the same number of bits as the input data. Iterative encryption uses a loop structure in which permutations and substitutions of input data are repeated. Figure 1 shows AES encrypting and decrypting a 16-bit byte data block with a 192-bit key.</p>
<h4 id="1-9-1-2-Algorithm-Description"><a href="#1-9-1-2-Algorithm-Description" class="headerlink" title="1.9.1.2 Algorithm Description"></a>1.9.1.2 Algorithm Description</h4><p>AES The encryption process operates on a 4 × 4 byte matrix, also known as “state”, whose initial value is a Plain Text block (the size of an element in the matrix is a Byte of the Plain Text block). (Rijndael encryption method supports larger blocks, and the number of rows of the matrix can be increased as appropriate.) When encrypting, each round of AES encryption cycle (except the last round) consists of 4 steps:</p>
<ol>
<li><p>AddRoundKey - Each byte in the matrix is XOR with the round key; each sub-key is generated by the key generation scheme.</p>
</li>
<li><p>SubBytes - Through a nonlinear replacement Function, each byte is replaced with the corresponding byte in the way of Look up table.</p>
</li>
<li><p>ShiftRows - Shift each column in the matrix cyclically.</p>
</li>
</ol>
<p>MixColumns - To fully blend the operations of the individual straight lines in the matrix. This step uses a linear transformation to mix four bytes per internal connection. The MixColumns step is omitted in the last encryption loop and replaced with another AddRoundKey.</p>
<p><strong>S box transform (SubBytes)</strong></p>
<p>Each byte in the matrix is transformed by an 8-bit S-box. This step provides the transformation capability of cryptographic nonlinearity. The S-box is related to the multiplicative inverse element on GF (28) and is known to have good nonlinear properties. To avoid attacks of simple algebraic properties, the S-box is constructed by combining the multiplicative inverse element and an invertible affine transformation matrix. In addition, when constructing the S-box, fixed points and inverse fixed points are deliberately avoided, that is, replacing bytes with S-boxes will result in misalignment. For example, one byte is 0x19, and after the S-box transformation, we find n (1,9) &#x3D; 0xd4, so we replace it with 0xd4.  </p>
<p><img src="wps89.jpg" alt="img"> </p>
<p><strong>ShiftRows</strong></p>
<p>ShiftRows describes row operations in a matrix. In this step, each row is cyclic shifted to the left by a certain offset. In AES (block size 128 bits), the first row remains the same, and each byte in the second row is cyclic moved one grid to the left. Similarly, the third and fourth rows are cyclic shifted to the left by 2 and 3, respectively. After ShiftRows, each vertical column in the matrix consists of elements from each different column in the input matrix.</p>
<p><strong>Column Transform (MixColumns)</strong></p>
<p>In the MixColumns step, the four bytes of each column are combined by a linear transformation. The four elements of each column are treated as coefficients, and the combination is a polynomial in GF (28). Then the polynomial is multiplied with a fixed polynomial under modulo. This step can also be regarded as matrix multiplication under Rijndael finite fields. The MixColumns Function accepts 4 bytes of input and outputs 4 bytes. Each input byte affects the output four bytes. Therefore, the two steps of ShiftRows and MixColumns provide diffusion for this cryptosystem.</p>
<p><strong>Extended Key (AddRoundKey)</strong></p>
<p>The AES Algorithm uses the external input key K (the number of words in the keystring is Nk) to obtain a total of 4 (Nr + 1) words of the extended key through the key extension program. It involves the following three modules:</p>
<p>(1) rotword - changing a 4-byte sequence [A, B, C, D] into [B, C, D, A];</p>
<p>(2) S-box transformation (subword) - a 4-byte S-box instead;</p>
<p>(3) Transform Rcon [i] - Rcon [i] represents the 32-bit bit word [xi-1,00,00,00]. Here x is (02), such as Rcon [1] &#x3D; [01000000]; Rcon [2] &#x3D; [02000000]; Rcon [3] &#x3D; [04000000]…</p>
<p>Extension key generation: The first Nk words of the extension key are the external key K; the following words W [[i]] are equal to the “exclusive OR” of its previous word W [[i-1]] and the first Nk words W [[i-Nk]], that is, W [[i]] &#x3D; W [[i-1]] W [[i-Nk]]. But if i is a multiple of Nk, then W [i] &#x3D; W [i-Nk] Subword (Rotword (W [[[i-1]])) Rcon [i&#x2F;Nk].</p>
<h4 id="AES-Algorithm-Implementation"><a href="#AES-Algorithm-Implementation" class="headerlink" title="AES Algorithm Implementation"></a>AES Algorithm Implementation</h4><p>We encapsulate the AES Algorithm into a class in the form of a class, so that it is easy to call its encryption and decryption Algorithm to realize the encryption and decryption operations for files.</p>
<p>1.9.2.1 data members</p>
<p>The data member consists of three parts: S_Box, used as the S-box used for encryption, Inv_S_Box, used as the inverse S-box, that is, the replacement box corresponding to the decryption period, and Rcon, round constant, used in key expansion.</p>
<p>Byte S_Box [16] [16] &#x3D; {…}; Byte Inv_S_Box [16] [16] &#x3D; {…};&#x2F;&#x2F;round constant (AES-128 only takes 10 rounds) word Rcon [10] &#x3D; {…};</p>
<h4 id="Function-member-1"><a href="#Function-member-1" class="headerlink" title="Function member"></a>Function member</h4><p>Function members mainly contain the details of AES operations, call methods, etc., the outermost encapsulated’void AES_decrypt (Byte * plain, Byte * key) ‘Function and’void AES_encrypt (Byte * plain, Byte * key) ‘ Function, as the top-level encryption and decryption Function.</p>
<p>Among them, the column mixing and inverse operations in’void MixColumns (Byte mtx [4 * 4]) ‘are implemented by a fast Algorithm. GFMul is a multiplication operation on a finite field. For other Algorithm details, please refer to the appendix.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">AES</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">...</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(Byte in[<span class="number">4</span> * <span class="number">4</span>], word w[<span class="number">4</span> * (Nr + <span class="number">1</span>)])</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">encrypt</span><span class="params">(Byte in[<span class="number">4</span> * <span class="number">4</span>], word w[<span class="number">4</span> * (Nr + <span class="number">1</span>)])</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">KeyExpansion</span><span class="params">(Byte key[<span class="number">4</span> * Nk], word w[<span class="number">4</span> * (Nr + <span class="number">1</span>)])</span></span>;</span><br><span class="line">        <span class="function">word <span class="title">SubWord</span><span class="params">(word sw)</span></span>;</span><br><span class="line">        <span class="function">word <span class="title">RotWord</span><span class="params">(word&amp; rw)</span></span>;</span><br><span class="line">        <span class="function">word <span class="title">Word</span><span class="params">(Byte&amp; k1, Byte&amp; k2, Byte&amp; k3, Byte&amp; k4)</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">InvMixColumns</span><span class="params">(Byte mtx[<span class="number">4</span> * <span class="number">4</span>])</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">InvShiftRows</span><span class="params">(Byte mtx[<span class="number">4</span> * <span class="number">4</span>])</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">InvSubBytes</span><span class="params">(Byte mtx[<span class="number">4</span> * <span class="number">4</span>])</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">AddRoundKey</span><span class="params">(Byte mtx[<span class="number">4</span> * <span class="number">4</span>], word k[<span class="number">4</span>])</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">MixColumns</span><span class="params">(Byte mtx[<span class="number">4</span> * <span class="number">4</span>])</span></span>;</span><br><span class="line">        <span class="function">Byte <span class="title">GFMul</span><span class="params">(Byte a, Byte b)</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">ShiftRows</span><span class="params">(Byte mtx[<span class="number">4</span> * <span class="number">4</span>])</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">SubBytes</span><span class="params">(Byte mtx[<span class="number">4</span> * <span class="number">4</span>])</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">AES_decrypt</span><span class="params">(Byte* plain, Byte* key)</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">AES_encrypt</span><span class="params">(Byte* plain, Byte* key)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h3 id="AES-CBC-model-encrypted-files"><a href="#AES-CBC-model-encrypted-files" class="headerlink" title="AES- CBC model encrypted files"></a>AES- CBC model encrypted files</h3><h4 id="CBC-model-principle"><a href="#CBC-model-principle" class="headerlink" title="CBC model principle"></a>CBC model principle</h4><h5 id="Concept-analysis"><a href="#Concept-analysis" class="headerlink" title="Concept analysis"></a>Concept analysis</h5><p>The full name of the CBC model is Cipher Block Chaining, which is called because ciphertext groups are connected to each other like chains.</p>
<p>In the CBC model, the Plain Text group is first XOR with the previous ciphertext group, and then encrypted.</p>
<p>CBC model encryption and decryption process is as follows:</p>
<p><img src="wps90.jpg" alt="img"> </p>
<h5 id="Initialization-vector"><a href="#Initialization-vector" class="headerlink" title="Initialization vector"></a>Initialization vector</h5><p>When encrypting the first Plain Text packet, since there is no “previous ciphertext packet”, it is necessary to prepare a bit sequence of length for one packet in advance to replace the “previous ciphertext packet”, this bit sequence is called Initialization Vector, usually abbreviated as IV. Generally speaking, a different bit sequence is randomly generated each time encryption is used as an initialization vector.</p>
<p>Features of the CBC model</p>
<p>Plain Text packets are always XOR with the “previous ciphertext packet” before encryption, so even if the values of Plain Text packet 1 and Plain Text packet 2 are equal, the values of ciphertext packets 1 and 2 are not necessarily equal. In this way, the defect of ECB mode does not exist in the CBC model.</p>
<p>Encryption process: In the CBC model, it is not possible to encrypt an intermediate Plain Text group alone. For example, if you want to generate ciphertext group 3, you need to gather at least Plain Text groups 1, 2, and 3.</p>
<p>Decryption process: Suppose one of the ciphertext packets encrypted by the CBC model is corrupted. In this case, as long as the length of the ciphertext packet does not change, at most 2 packets will be affected by data corruption during decryption. See the figure below:</p>
<p><img src="wps91.jpg" alt="img"> </p>
<h4 id="AES-CBC-model-implementation"><a href="#AES-CBC-model-implementation" class="headerlink" title="AES- CBC model implementation"></a>AES- CBC model implementation</h4><p>We encapsulate AES_FILE class to achieve the use of AES file operations. For AES file operations, we read the file through fstream Header File and encrypt the file using the CBC model.</p>
<h5 id="data-member-1"><a href="#data-member-1" class="headerlink" title="data member"></a>data member</h5><p>MAX_LEN: define the file length; PLAIN_LEN: define the size of the Plain Text packet required for each processing; bplain array is used to store the Plain Text content below the packet; key stores the temporary session key; IV stores the initial vector.</p>
<h5 id="Function-member-2"><a href="#Function-member-2" class="headerlink" title="Function member"></a>Function member</h5><p>Void encode_file (): AES-CBC model to encrypt the file; decode_file (): AES-CBC model to decrypt the file; void store_file (string name, bool type) to store the encrypted or decrypted file; void read_file (string name, bool type): read the file to be encrypted or decrypted and convert it into the file format required by the AES-CBC model; void set_temp_key (string Key16): assign a randomly generated session key.</p>
<p>The definition of the specific class and the class member Function are defined as follows, and the specific Function content and analysis are shown in the appendix.</p>
<p>class AES_FILE {private:        static const int MAX_LEN &#x3D; 5000;        static const int PLAIN_LEN &#x3D; 16;        int data_len;        Byte** bplain,<em><em>bplain_copy;        Byte key[16];        char byte_to_char(Byte a);        Byte</em> IV;public:        void set_temp_key(string Key16);        void read_file(string name, bool type);        void encode_file();        void decode_file();        void store_file(string name, bool type);        void CBC_xor(int index);        void CBC_shapeIV(Byte</em>* IV_data, int index);        void CBC_copyBplain(int index);};</p>
<h2 id="RSA-module-design"><a href="#RSA-module-design" class="headerlink" title="RSA module design"></a>RSA module design</h2><p>The RSA Algorithm</p>
<h4 id="Algorithm-Overview-1"><a href="#Algorithm-Overview-1" class="headerlink" title="Algorithm Overview"></a>Algorithm Overview</h4><p>RSA Algorithm is the most widely used public key cryptography algorithm today, and it is also known as the most secure encryption algorithm on earth. According to the use of the key, the password can be divided into symmetric cryptography and public key cryptography:</p>
<p>Symmetric cipher: A way of encrypting and decrypting using the same key</p>
<p>Public key ciphers: The way encryption and decryption use different ciphers, so public key ciphers are often also called asymmetric ciphers.</p>
<h4 id="Algorithm-description-1"><a href="#Algorithm-description-1" class="headerlink" title="Algorithm description"></a>Algorithm description</h4><ol>
<li>RSA encryption process</li>
</ol>
<p>RSA encryption process can be expressed using a general formula<br>$$<br>Ciphertext &#x3D; plaintext\ E\ mod\ N<br>$$</p>
<p>That is RSA encryption is the process of dividing the E power of Plain Text by N and finding the remainder.</p>
<p>From the general formula, as long as you know $E $and $N $, anyone can RSA encryption, so $E, N $is RSA encryption key, that is, the combination of $E $and $N $is the public key, we use $ (E, N) $to represent the public key</p>
<p>Public key &#x3D; (E, N)</p>
<p>However, $E $and $N $are not just any numbers. They are all calculated by strict mathematics. What requirements and properties $E $and $N $have will be discussed later. By the way, E is the first letter of encryption (Encryption), and N is the first letter of number (Number)</p>
<ol start="2">
<li>RSA decryption process</li>
</ol>
<p>The decryption of $RSA $can also be expressed using a general formula<br>$$<br>Plaintext &#x3D; ciphertext\ D\ mod\ N<br>$$<br>That is to say, the remainder of the ciphertext divided by N after the D power is Plain Text, which is RSA decryption process. Knowing D and N can decrypt the ciphertext, so the combination of D and N is the private key</p>
<p>$$<br>Private Key &#x3D; (D,N)<br>$$<br>It can be seen from the above RSA encryption and decryption are the same, encryption is “mod N to the power of E”; decryption is “mod N to the power of D.” Here D is the first letter of decryption; N is the first letter of number (Number).</p>
<ol start="3">
<li>Generate a key pair</li>
</ol>
<p>Since the public key is (E, N) and the private key is (D, N), the key pair is (E, D, N) but how is the key pair generated? The steps are as follows:</p>
<p>Find N; find L (L is the middle number of the intermediate process); find E; find D</p>
<p>(1) Find N</p>
<p>Prepare two prime numbers p and q. these two numbers cannot be too small, too small will be easy to crack, multiply p by 1</p>
<p>Get N.</p>
<p>(2) Ask L</p>
<p>L is the least common multiple of p-1 and q-1 and can be represented by the following expression<br>$$<br>L &#x3D; lcm(p-1,q-1)<br>$$<br>(3) Ask E</p>
<p>E must satisfy two conditions: E is a number greater than 1 and smaller than L, and the greatest common divisor of E and L is 1</p>
<p>Use gcd (X, Y) to represent X, and the greatest common divisor of Y is the E condition as follows:<br>$$<br>1&lt;E&lt;L,\ gcd(E,L)&#x3D;1<br>$$<br>The greatest common divisor of E and L is required to be 1 in order to guarantee that there must be a number D to decrypt. Now that we have found E and N, we have generated the public key in the key pair.</p>
<p>(4) Ask D</p>
<p>The number D is calculated from the number E. The following relationship must be satisfied between D, E and L:<br>$$<br>1&lt;D&lt;L,D\times L&#x3D;1<br>$$<br>As long as D satisfies the above two conditions, the ciphertext encrypted by E and N can be decrypted with D and N.</p>
<h3 id="RSA-Algorithm-implementation"><a href="#RSA-Algorithm-implementation" class="headerlink" title="RSA Algorithm implementation"></a>RSA Algorithm implementation</h3><p>RSA Algorithm is the top-level and core Algorithm of this project. As a linking program for other projects, it has the most interfaces and is more complicated to implement. It can be mainly divided into three sections: random key generation, RSA encryption section, RSA decryption section.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">RSA_key</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    ZZ p;</span><br><span class="line">    ZZ q;</span><br><span class="line">    ZZ euler;</span><br><span class="line">ZZ n;</span><br><span class="line">ZZ e;<span class="comment">//encryption key</span></span><br><span class="line">ZZ d;<span class="comment">//decryption key</span></span><br><span class="line">    string str1;</span><br><span class="line"><span class="comment">//key 1 hexadecimal</span></span><br><span class="line">    string str2 ;</span><br><span class="line"><span class="comment">//key 2 hexadecimal</span></span><br><span class="line">    string s ;</span><br><span class="line"><span class="comment">//Initial value of Random Seed</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Selection</span><span class="params">(ZZ&amp; e, ZZ euler)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">SaveKey</span><span class="params">(<span class="type">const</span> ZZ e, <span class="type">const</span> ZZ d, <span class="type">const</span> ZZ n)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">KeyGeneration</span><span class="params">(ZZ&amp; d, ZZ&amp; e, <span class="type">const</span> ZZ euler)</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getPublicKey</span><span class="params">(RSA_key giver)</span></span>;</span><br><span class="line">    <span class="function">ZZ <span class="title">MyRandomPrime</span><span class="params">(<span class="type">int</span> bitnum, <span class="type">bool</span> prime_flag)</span></span>;</span><br><span class="line">    <span class="function">ZZ <span class="title">string16_to_ZZ</span><span class="params">(string str)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">key_create</span><span class="params">(<span class="type">bool</span> mode, <span class="type">int</span> bitnum)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Encryption</span><span class="params">(string file_in, string file_out)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Decryption</span><span class="params">(string file_in, string file_out)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">ZZ_to_string16</span><span class="params">(ZZ a)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">readPublicKey</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">readPrivateKey</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h5 id="Random-key-generation"><a href="#Random-key-generation" class="headerlink" title="Random key generation"></a>Random key generation</h5><p>Since random key generation requires a random key with implementation lengths of 512 bits and 1024 bits, we need to implement RandomPrime Function, call ANSI X9.17 Algorithm and Miller’s primacy detection Algorithm to jointly generate the random key q, p. At the same time, Selection Algorithm calls ANSI X9.17 Algorithm to generate the random number e encryption key, and uses Euclidean Algorithm to ensure that the result of e is coprime with euler, so as to ensure the reliability of the generated key.</p>
<p>Functions specifically involved include the following:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Void <span class="title">Selection</span> <span class="params">(ZZ &amp; e, ZZ euler)</span></span>;<span class="comment">//The result of generating e is prime of the euler</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">SaveKey</span><span class="params">(<span class="type">const</span> ZZ e, <span class="type">const</span> ZZ d, <span class="type">const</span> ZZ n)</span></span>;<span class="comment">//保存密钥</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">KeyGeneration</span><span class="params">(ZZ&amp; d, ZZ&amp; e, <span class="type">const</span> ZZ euler)</span></span>;<span class="comment">//生成密钥d和e</span></span><br><span class="line"><span class="function">ZZ <span class="title">MyRandomPrime</span> <span class="params">(<span class="type">int</span> bitnum, <span class="type">bool</span> prime_flag)</span></span>;</span><br><span class="line"><span class="function">ZZ <span class="title">string16_to_ZZ</span> <span class="params">(string str)</span></span>;<span class="comment">//hexadecimal to ZZ Function</span></span><br><span class="line"><span class="function">Void <span class="title">key_create</span> <span class="params">(<span class="type">bool</span> mode, <span class="type">int</span> bitnum)</span></span>;</span><br><span class="line"><span class="function">String <span class="title">ZZ_to_string16</span> <span class="params">(ZZ a)</span></span>;<span class="comment">//ZZ to hexadecimal Function</span></span><br></pre></td></tr></table></figure>

<h4 id="RSA-encryption-algorithm-implementation"><a href="#RSA-encryption-algorithm-implementation" class="headerlink" title="RSA encryption algorithm implementation"></a>RSA encryption algorithm implementation</h4><p>RSA encryption algorithm is for the temporary session key encryption. At the same time, before encrypting, we need to read the encryption key (public key) through the file operation to encrypt. For the encryption result of the temporary session key, we store it as c1, use the temporary session key, call AES-CBC Algorithm encryption to encrypt the file, the encrypted result is stored in c2, c1, c2 are stored as files, and provided to the decryption operation for decryption.</p>
<p>The specifically designed Functions include the following:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">SaveKey</span><span class="params">(<span class="type">const</span> ZZ e, <span class="type">const</span> ZZ d, <span class="type">const</span> ZZ n)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Encryption</span><span class="params">(string file_in, string file_out)</span></span>;</span><br><span class="line"><span class="function">string <span class="title">ZZ_to_string16</span><span class="params">(ZZ a)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">readPublicKey</span><span class="params">()</span></span>; </span><br></pre></td></tr></table></figure>

<h4 id="RSA-Decryption-Algorithm-Implementation"><a href="#RSA-Decryption-Algorithm-Implementation" class="headerlink" title="RSA Decryption Algorithm Implementation"></a>RSA Decryption Algorithm Implementation</h4><p>Similar to an encryption algorithm. RSA decryption algorithm first needs to read the corresponding private key, encrypted file c1, encrypted file c2, decrypt the encrypted file c1 with the private key to obtain our temporary session key, and then use the temporary session key as the decryption key of the AES algorithm to decrypt file c2 to obtain our Plain Text m, and finally output the obtained Plain Text m to the file. So far, the entire RSA-key generation, encryption, and decryption algorithm is finished.</p>
<p>The RSA related functions are as follows:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">SaveKey</span><span class="params">(<span class="type">const</span> ZZ e, <span class="type">const</span> ZZ d, <span class="type">const</span> ZZ n)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Decryption</span><span class="params">(string file_in, string file_out)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">readPrivateKey</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<h1 id="Chapter-3-Experimental-Design-and-Program-Run-Instructions"><a href="#Chapter-3-Experimental-Design-and-Program-Run-Instructions" class="headerlink" title="Chapter 3, Experimental Design and Program Run Instructions"></a>Chapter 3, Experimental Design and Program Run Instructions</h1><h2 id="Experimental-Design-Description"><a href="#Experimental-Design-Description" class="headerlink" title="Experimental Design Description"></a>Experimental Design Description</h2><p>We can roughly simulate the operation idea of the entire program, but in order to better fit the real situation, there are three different steps:</p>
<ol>
<li><p>Alice generates a random key and transmits the public key to Bob at the same time</p>
</li>
<li><p>Bob gets the public key, generates a random session key for file encryption, and transmits the ciphertext (c1, c2) to Alice</p>
</li>
<li><p>Alice obtains the private key generated by herself, and decrypts the file to obtain Plain Text.</p>
</li>
</ol>
<p>Among them, Bob and Alice are two independent individuals, how can they reflect the “independence” of their respective information and the independence of encryption and decryption?</p>
<h3 id="Instantiate-two-different-classes-on-Bob-and-Alice-respectively"><a href="#Instantiate-two-different-classes-on-Bob-and-Alice-respectively" class="headerlink" title="Instantiate two different classes on Bob and Alice respectively"></a>Instantiate two different classes on Bob and Alice respectively</h3><p>We exemplify Alice and Bob as two classes respectively:</p>
<p><code>RSA_key ALICE_privateRSA</code></p>
<p><code>RSA_key BOB_publicRSA</code></p>
<p>For Alice and Bob can not share the public and private keys, Bob can only get RSA Public_Key in key generation, Alice can only get RSA key generation Private_Key, more in line with the real situation of the encryption and decryption process, to ensure the independence of information.</p>
<h3 id="The-program-runs-in-three-different-stages"><a href="#The-program-runs-in-three-different-stages" class="headerlink" title="The program runs in three different stages"></a>The program runs in three different stages</h3><p>We “interrupt” the whole program into three different stages - Alice generates random key; Bob obtains public key encryption; Alice obtains private key decryption. Each stage chooses to terminate the program immediately after execution, which can effectively eliminate the intermediate variables after running the program. The encrypted and decrypted information can only be obtained by reading the file, which simulates the characteristics of file transmission and is more in line with the independence of the encryption and decryption process.</p>
<h2 id="Program-running-instructions"><a href="#Program-running-instructions" class="headerlink" title="Program running instructions"></a>Program running instructions</h2><h4 id="Random-key-generation-section"><a href="#Random-key-generation-section" class="headerlink" title="Random key generation section"></a>Random key generation section</h4><p>First, after entering, you need to select the program mode. Before encryption, please select 1 to generate RSA public and private keys</p>
<p><img src="wps95.jpg" alt="img"> </p>
<ol start="2">
<li>Enter 1 in the cmd window, and then the length of the key to be generated will be displayed, 512bit and 1024bit, choose according to the requirements:</li>
</ol>
<p><img src="wps96.jpg" alt="img"> </p>
<p>3, after selecting the key length, the program automatically executes RSA key generation process</p>
<p><img src="wps97.jpg" alt="img"> </p>
<ol start="4">
<li>After the generation is successful, it is prompted to store the public key in the PublicKey.txt and the private key in the PrivateKey.txt for use in the next stage. At the same time, you can close the program to complete all the processes of RSA key generation.</li>
</ol>
<h4 id="Bob-RSA-encryption"><a href="#Bob-RSA-encryption" class="headerlink" title="Bob RSA encryption"></a>Bob RSA encryption</h4><ol start="5">
<li>After entering again, you need to select the program mode, select 2: Bob encryption mode</li>
</ol>
<p><img src="wps98.jpg" alt="img"> </p>
<p>6, the encryption part of the RSA will be carried out during the period, and the encryption process will be displayed in the cmd window, including:</p>
<p>(1) Random session key generation process</p>
<p><img src="wps99.jpg" alt="img"> </p>
<p>(2) Reading files and encryption process</p>
<p><img src="wps100.jpg" alt="img"> </p>
<p>(3) AES encryption result of the file</p>
<p><img src="wps101.jpg" alt="img"> </p>
<p>(4) Encryption and storage of session keys</p>
<p><img src="wps102.jpg" alt="img"> </p>
<h4 id="Alice-RSA-decryption-section"><a href="#Alice-RSA-decryption-section" class="headerlink" title="Alice RSA decryption section"></a>Alice RSA decryption section</h4><ol start="7">
<li>After re-entering, you need to select the program mode, select 3: Alice decryption mode</li>
</ol>
<p><img src="wps103.jpg" alt="img"> </p>
<ol start="8">
<li>In this mode, the reading and decryption process of the ciphertext c1 and c2 files will be automatically performed. Similar to the encryption process, the temporary session key, the original information of the ciphertext and the decryption information will be displayed.</li>
</ol>
<p>(1) Decryption of the temporary key</p>
<p><img src="wps104.jpg" alt="img"> </p>
<p>(2) Decryption of ciphertext</p>
<p><img src="wps105.jpg" alt="img"> </p>
<p><img src="wps106.jpg" alt="img"> </p>
<p><img src="wps107.jpg" alt="img"> </p>
<ol start="9">
<li>During the execution of the program, the temporary session key, the Plain Text and ciphertext information of the file are saved, which is convenient for inspection after the execution is completed.</li>
</ol>
<p><img src="wps108.jpg" alt="img"> </p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">YAMY</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yamy1234.github.io/2022/12/13/project-collections-RSA_Encript_System/">http://yamy1234.github.io/2022/12/13/project-collections-RSA_Encript_System/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/12/13/project-collections-L2TP_VPN_Experiment/"><img class="prev-cover" src="/img/2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">project collections: L2TP VPN Experiment</div></div></a></div><div class="next-post pull-right"><a href="/2022/12/13/project-collections-LinuxPersonalFirewall/"><img class="next-cover" src="/img/5.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">project collections: Linux Personal Firewall</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/head.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">YAMY</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">19</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">6</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#2021-Modern-Cryptography-Curriculum-Design-Task"><span class="toc-number">1.</span> <span class="toc-text">2021 Modern Cryptography Curriculum Design Task</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Summary"><span class="toc-number">2.</span> <span class="toc-text">Summary</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-1-Topic-Background"><span class="toc-number">3.</span> <span class="toc-text">Chapter 1, Topic Background</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Programming-tasks-and-requirements"><span class="toc-number">3.1.</span> <span class="toc-text">Programming tasks and requirements</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Alice-generates-RSA-key"><span class="toc-number">3.1.1.</span> <span class="toc-text">Alice generates RSA key:</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#description"><span class="toc-number">3.1.1.1.</span> <span class="toc-text">description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#request"><span class="toc-number">3.1.1.2.</span> <span class="toc-text">request</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bob-encrypts-file-m-and-sends-it-to-Alice"><span class="toc-number">3.1.2.</span> <span class="toc-text">Bob encrypts file m and sends it to Alice:</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#description-1"><span class="toc-number">3.1.2.1.</span> <span class="toc-text">description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Requirements"><span class="toc-number">3.1.2.2.</span> <span class="toc-text">Requirements</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-Alice-decrypts-and-recovers-file-m"><span class="toc-number">3.1.3.</span> <span class="toc-text">1.3 Alice decrypts and recovers file m</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-1-Description"><span class="toc-number">3.1.3.1.</span> <span class="toc-text">1.3.1 Description</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Restriction-requirements"><span class="toc-number">3.2.</span> <span class="toc-text">Restriction requirements</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-2-Programming-Instructions"><span class="toc-number">4.</span> <span class="toc-text">Chapter 2, Programming Instructions</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Programming-Overall-Architecture"><span class="toc-number">4.1.</span> <span class="toc-text">Programming Overall Architecture</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA-Encryption-System-Overall-Framework"><span class="toc-number">4.1.1.</span> <span class="toc-text">RSA Encryption System Overall Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-General-framework-for-programming"><span class="toc-number">4.1.2.</span> <span class="toc-text">1.5 General framework for programming</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Programming-Detailed-design-instructions-for-each-module"><span class="toc-number">4.2.</span> <span class="toc-text">Programming Detailed design instructions for each module</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Algorithm-Design"><span class="toc-number">4.3.</span> <span class="toc-text">Algorithm Design</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Algorithm-principle"><span class="toc-number">4.3.1.</span> <span class="toc-text">Algorithm principle</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Calculate-16-subkeys"><span class="toc-number">4.3.1.0.1.</span> <span class="toc-text">Calculate 16 subkeys</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Encrypt-and-decrypt-data-block"><span class="toc-number">4.3.1.0.2.</span> <span class="toc-text">Encrypt and decrypt data block</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DES-Algorithm-implementation"><span class="toc-number">4.3.1.1.</span> <span class="toc-text">DES Algorithm implementation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#data-member"><span class="toc-number">4.3.1.1.1.</span> <span class="toc-text">data member</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Function-member"><span class="toc-number">4.3.1.1.2.</span> <span class="toc-text">Function member</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ANSI-X9-17-Module-Algorithm-Design"><span class="toc-number">4.3.2.</span> <span class="toc-text">ANSI X9.17 Module Algorithm Design</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ANSI-X9-17-Algorithm-Principle"><span class="toc-number">4.3.2.1.</span> <span class="toc-text">ANSI X9.17 Algorithm Principle</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Algorithm-Background"><span class="toc-number">4.3.2.2.</span> <span class="toc-text">Algorithm Background</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Algorithm-implementation-process"><span class="toc-number">4.3.2.2.1.</span> <span class="toc-text">Algorithm implementation process</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Algorithm-description"><span class="toc-number">4.3.2.3.</span> <span class="toc-text">Algorithm description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ANSI-X9-17-Algorithm-Implementation"><span class="toc-number">4.3.2.4.</span> <span class="toc-text">ANSI X9.17 Algorithm Implementation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#string-threeDES-string-a-string-key1-string-key2-DES-des"><span class="toc-number">4.3.2.4.1.</span> <span class="toc-text">string threeDES(string a, string key1, string key2, DES des)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#string-string-to-hex-const-string-amp-str"><span class="toc-number">4.3.2.4.2.</span> <span class="toc-text">string string_to_hex(const string&amp; str)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Ansi-int-m-string-key1-string-key2-string-s-char-result"><span class="toc-number">4.3.2.4.3.</span> <span class="toc-text">Ansi(int m, string key1, string key2, string s, char** result)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#The-Principle-of-Miller-Ruo-Ice-Primality-Detection-Algorithm"><span class="toc-number">4.3.2.5.</span> <span class="toc-text">The Principle of Miller Ruo Ice Primality Detection Algorithm</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Conclusion"><span class="toc-number">4.3.2.5.1.</span> <span class="toc-text">Conclusion</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AES-Algorithm-Design"><span class="toc-number">4.3.3.</span> <span class="toc-text">AES Algorithm Design</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#AES-Algorithm-principle"><span class="toc-number">4.3.3.1.</span> <span class="toc-text">AES Algorithm principle</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Algorithm-Overview"><span class="toc-number">4.3.3.2.</span> <span class="toc-text">Algorithm Overview</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-1-2-Algorithm-Description"><span class="toc-number">4.3.3.3.</span> <span class="toc-text">1.9.1.2 Algorithm Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AES-Algorithm-Implementation"><span class="toc-number">4.3.3.4.</span> <span class="toc-text">AES Algorithm Implementation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Function-member-1"><span class="toc-number">4.3.3.5.</span> <span class="toc-text">Function member</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AES-CBC-model-encrypted-files"><span class="toc-number">4.3.4.</span> <span class="toc-text">AES- CBC model encrypted files</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CBC-model-principle"><span class="toc-number">4.3.4.1.</span> <span class="toc-text">CBC model principle</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Concept-analysis"><span class="toc-number">4.3.4.1.1.</span> <span class="toc-text">Concept analysis</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Initialization-vector"><span class="toc-number">4.3.4.1.2.</span> <span class="toc-text">Initialization vector</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AES-CBC-model-implementation"><span class="toc-number">4.3.4.2.</span> <span class="toc-text">AES- CBC model implementation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#data-member-1"><span class="toc-number">4.3.4.2.1.</span> <span class="toc-text">data member</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Function-member-2"><span class="toc-number">4.3.4.2.2.</span> <span class="toc-text">Function member</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA-module-design"><span class="toc-number">4.4.</span> <span class="toc-text">RSA module design</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Algorithm-Overview-1"><span class="toc-number">4.4.0.1.</span> <span class="toc-text">Algorithm Overview</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Algorithm-description-1"><span class="toc-number">4.4.0.2.</span> <span class="toc-text">Algorithm description</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA-Algorithm-implementation"><span class="toc-number">4.4.1.</span> <span class="toc-text">RSA Algorithm implementation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Random-key-generation"><span class="toc-number">4.4.1.0.1.</span> <span class="toc-text">Random key generation</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RSA-encryption-algorithm-implementation"><span class="toc-number">4.4.1.1.</span> <span class="toc-text">RSA encryption algorithm implementation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RSA-Decryption-Algorithm-Implementation"><span class="toc-number">4.4.1.2.</span> <span class="toc-text">RSA Decryption Algorithm Implementation</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-3-Experimental-Design-and-Program-Run-Instructions"><span class="toc-number">5.</span> <span class="toc-text">Chapter 3, Experimental Design and Program Run Instructions</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Experimental-Design-Description"><span class="toc-number">5.1.</span> <span class="toc-text">Experimental Design Description</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Instantiate-two-different-classes-on-Bob-and-Alice-respectively"><span class="toc-number">5.1.1.</span> <span class="toc-text">Instantiate two different classes on Bob and Alice respectively</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-program-runs-in-three-different-stages"><span class="toc-number">5.1.2.</span> <span class="toc-text">The program runs in three different stages</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Program-running-instructions"><span class="toc-number">5.2.</span> <span class="toc-text">Program running instructions</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Random-key-generation-section"><span class="toc-number">5.2.0.1.</span> <span class="toc-text">Random key generation section</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Bob-RSA-encryption"><span class="toc-number">5.2.0.2.</span> <span class="toc-text">Bob RSA encryption</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Alice-RSA-decryption-section"><span class="toc-number">5.2.0.3.</span> <span class="toc-text">Alice RSA decryption section</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/12/13/about_myself/" title="A Page about Myself"><img src="/img/4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="A Page about Myself"/></a><div class="content"><a class="title" href="/2023/12/13/about_myself/" title="A Page about Myself">A Page about Myself</a><time datetime="2023-12-13T11:13:37.000Z" title="Created 2023-12-13 19:13:37">2023-12-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/14/crossDomainReidentification/" title="project collections: National Innovation and Entrepreneurship Training - Cross-Domain ReID"><img src="/img/3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="project collections: National Innovation and Entrepreneurship Training - Cross-Domain ReID"/></a><div class="content"><a class="title" href="/2022/12/14/crossDomainReidentification/" title="project collections: National Innovation and Entrepreneurship Training - Cross-Domain ReID">project collections: National Innovation and Entrepreneurship Training - Cross-Domain ReID</a><time datetime="2022-12-14T04:23:37.000Z" title="Created 2022-12-14 12:23:37">2022-12-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/13/project-collections-L2TP_VPN_Experiment/" title="project collections: L2TP VPN Experiment"><img src="/img/2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="project collections: L2TP VPN Experiment"/></a><div class="content"><a class="title" href="/2022/12/13/project-collections-L2TP_VPN_Experiment/" title="project collections: L2TP VPN Experiment">project collections: L2TP VPN Experiment</a><time datetime="2022-12-13T04:23:37.000Z" title="Created 2022-12-13 12:23:37">2022-12-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/13/project-collections-RSA_Encript_System/" title="project collections: RSA Encrypt System"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="project collections: RSA Encrypt System"/></a><div class="content"><a class="title" href="/2022/12/13/project-collections-RSA_Encript_System/" title="project collections: RSA Encrypt System">project collections: RSA Encrypt System</a><time datetime="2022-12-13T04:16:37.000Z" title="Created 2022-12-13 12:16:37">2022-12-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/13/project-collections-LinuxPersonalFirewall/" title="project collections: Linux Personal Firewall"><img src="/img/5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="project collections: Linux Personal Firewall"/></a><div class="content"><a class="title" href="/2022/12/13/project-collections-LinuxPersonalFirewall/" title="project collections: Linux Personal Firewall">project collections: Linux Personal Firewall</a><time datetime="2022-12-13T04:13:37.000Z" title="Created 2022-12-13 12:13:37">2022-12-13</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By YAMY</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>